<!DOCTYPE html>
<html lang="en-gb">
  <head>
    <meta charset="UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Max Claus">
    <title>Max Claus&#x27; website</title>
    <meta name="description" content="">
    <meta property="og:type" content="article" >
    <meta name="image" property="og:image" content="https://maxclaus.xyz/og-image.webp">
    <link rel="stylesheet" href="https://maxclaus.xyz/site.css?h=9652046a01e4d4c12120" >
    <link rel="preconnect" href="https://rsms.me/">
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    <link rel="shortcut icon" type="image/png" href="https://maxclaus.xyz/favicon.png"/>
    <link rel="alternate" type="application/rss+xml" title="RSS" href="https://maxclaus.xyz/rss.xml">
    <!-- <script src="https://kit.fontawesome.com/f91b95dbd1.js" crossorigin="anonymous"></script> -->
  </head>

  <body>
    <div id="root">
      <header id="header">
        <ul class="breadcrumb">
          <li><a href="/">Max Claus</a></li>
          <li><a href="/blog">Blog</a></li>
        </ul>
        <ul class="menu">
          <li><a href="/">About</a></li>
          <li><a href="/blog/">Blog</a></li>
          <li><a href="/resume/">Resume</a></li>
          <li>
            <input id="dark-mode" type="checkbox" name="dark-mode" aria-label="Toggle theme">
            <label id="theme-toggle" for="dark-mode">
              <svg id="light-mode-icon" viewBox="0 0 32 32" width="20" height="20" preserveAspectRatio="xMidYMid meet">
                <circle cx="15" cy="15" r="6" fill="currentColor" />

                <line
                    id="ray"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    x1="15"
                    y1="1"
                    x2="15"
                    y2="4"
                    ></line>

                <use href="#ray" transform="rotate(45 15 15)" />
                <use href="#ray" transform="rotate(90 15 15)" />
                <use href="#ray" transform="rotate(135 15 15)" />
                <use href="#ray" transform="rotate(180 15 15)" />
                <use href="#ray" transform="rotate(225 15 15)" />
                <use href="#ray" transform="rotate(270 15 15)" />
                <use href="#ray" transform="rotate(315 15 15)" />
              </svg>
              <svg id="dark-mode-icon" viewBox="0 0 32 32" width="20" height="20" preserveAspectRatio="xMidYMid meet">
                <path
                    fill="currentColor"
                    d="
                       M 23, 5
                       A 12 12 0 1 0 23, 25
                       A 12 12 0 0 1 23, 5"
                    />
              </svg>
            </label>
          </li>
        </ul>
      </header>

      <div id="content">
        
<article itemscope itemtype="http://schema.org/BlogPosting" class="blog_post">
  <header>
    <h1 itemprop="name headline">Excluir todos os Objetos no SQL Server</h1>
    <div class="blog_post__meta">
      <span hidden
            itemprop="author"
            itemscope
            itemtype="http://schema.org/Person">
        <span itemprop="name">Max Claus</span>
      </span>

      
        <span>
          Posted on <span itemprop="datePublished">Nov 17, 2011</span>
        </span>
      

      

      
        <span class="blog_post__meta__sep" aria-hidden="true">·</span>
        <span>
          1 min. read
        </span>
      

      
    </div>
  </header>

  <div class="blog_post__body">
    <p>Este artigo é uma referência á um script que salvou tempo e serviço em um projeto atual. No qual precisávamos zerar o banco, mas com o detalhe que não poderíamos excluí-lo e criá-lo novamente.</p>
<p>Sendo assim o que este script faz é excluir todos os objetos nesta ordem:</p>
<ol>
<li>Stored Procedures</li>
<li>Views</li>
<li>Functions</li>
<li>Foreign Keys</li>
<li>Primary Keys</li>
<li>Tables</li>
<li>Indexes</li>
</ol>
<pre data-lang="sql" class="language-sql z-code"><code class="language-sql" data-lang="sql"><span class="z-source z-sql"><span class="z-comment z-line z-double-dash z-sql"><span class="z-punctuation z-definition z-comment z-sql">--</span> Drop all non-system stored procs
</span></span><span class="z-source z-sql">DECLARE @name <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">128</span>)
</span><span class="z-source z-sql">DECLARE @SQL <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">254</span>)
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @name <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> \[name\] <span class="z-keyword z-other z-DML z-sql">FROM</span> sysobjects <span class="z-keyword z-other z-DML z-sql">WHERE</span> \[type\] <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>P<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> category <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-constant z-numeric z-sql">0</span> <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> \[name\])
</span><span class="z-source z-sql">WHILE @name <span class="z-keyword z-operator z-logical z-sql">is</span> <span class="z-keyword z-operator z-logical z-sql">not</span> <span class="z-constant z-language z-sql">null</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-LUW z-sql">BEGIN</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @SQL <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>DROP PROCEDURE <span class="z-constant z-character z-escape z-sql">\[</span>dbo<span class="z-constant z-character z-escape z-sql">\]</span>.<span class="z-constant z-character z-escape z-sql">\[</span><span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> RTRIM(@name) <span class="z-keyword z-operator z-math z-sql">+</span><span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span><span class="z-constant z-character z-escape z-sql">\]</span><span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql">EXEC (@SQL)
</span><span class="z-source z-sql">PRINT <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>Dropped Procedure: <span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> @name
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @name <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> \[name\] <span class="z-keyword z-other z-DML z-sql">FROM</span> sysobjects <span class="z-keyword z-other z-DML z-sql">WHERE</span> \[type\] <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>P<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> category <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-constant z-numeric z-sql">0</span> <span class="z-keyword z-operator z-logical z-sql">AND</span> \[name\] <span class="z-keyword z-operator z-comparison z-sql">&gt;</span> @name <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> \[name\])
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">END</span>
</span><span class="z-source z-sql">GO
</span><span class="z-source z-sql">
</span><span class="z-source z-sql"><span class="z-comment z-line z-double-dash z-sql"><span class="z-punctuation z-definition z-comment z-sql">--</span> Drop all views
</span></span><span class="z-source z-sql">DECLARE @name <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">128</span>)
</span><span class="z-source z-sql">DECLARE @SQL <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">254</span>)
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @name <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> \[name\] <span class="z-keyword z-other z-DML z-sql">FROM</span> sysobjects <span class="z-keyword z-other z-DML z-sql">WHERE</span> \[type\] <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>V<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> category <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-constant z-numeric z-sql">0</span> <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> \[name\])
</span><span class="z-source z-sql">WHILE @name <span class="z-keyword z-operator z-logical z-sql">IS</span> <span class="z-keyword z-operator z-logical z-sql">NOT</span> <span class="z-constant z-language z-sql">NULL</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-LUW z-sql">BEGIN</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @SQL <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>DROP VIEW <span class="z-constant z-character z-escape z-sql">\[</span>dbo<span class="z-constant z-character z-escape z-sql">\]</span>.<span class="z-constant z-character z-escape z-sql">\[</span><span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> RTRIM(@name) <span class="z-keyword z-operator z-math z-sql">+</span><span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span><span class="z-constant z-character z-escape z-sql">\]</span><span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql">EXEC (@SQL)
</span><span class="z-source z-sql">PRINT <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>Dropped View: <span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> @name
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @name <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> \[name\] <span class="z-keyword z-other z-DML z-sql">FROM</span> sysobjects <span class="z-keyword z-other z-DML z-sql">WHERE</span> \[type\] <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>V<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> category <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-constant z-numeric z-sql">0</span> <span class="z-keyword z-operator z-logical z-sql">AND</span> \[name\] <span class="z-keyword z-operator z-comparison z-sql">&gt;</span> @name <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> \[name\])
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">END</span>
</span><span class="z-source z-sql">GO
</span><span class="z-source z-sql">
</span><span class="z-source z-sql"><span class="z-comment z-line z-double-dash z-sql"><span class="z-punctuation z-definition z-comment z-sql">--</span> Drop all functions
</span></span><span class="z-source z-sql">DECLARE @name <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">128</span>)
</span><span class="z-source z-sql">DECLARE @SQL <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">254</span>)
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @name <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> \[name\] <span class="z-keyword z-other z-DML z-sql">FROM</span> sysobjects <span class="z-keyword z-other z-DML z-sql">WHERE</span> \[type\] <span class="z-keyword z-operator z-logical z-sql">IN</span> (N<span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>FN<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>, N<span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>IF<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>, N<span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>TF<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>, N<span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>FS<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>, N<span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>FT<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>) <span class="z-keyword z-operator z-logical z-sql">AND</span> category <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-constant z-numeric z-sql">0</span> <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> \[name\])
</span><span class="z-source z-sql">WHILE @name <span class="z-keyword z-operator z-logical z-sql">IS</span> <span class="z-keyword z-operator z-logical z-sql">NOT</span> <span class="z-constant z-language z-sql">NULL</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-LUW z-sql">BEGIN</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @SQL <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>DROP FUNCTION <span class="z-constant z-character z-escape z-sql">\[</span>dbo<span class="z-constant z-character z-escape z-sql">\]</span>.<span class="z-constant z-character z-escape z-sql">\[</span><span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> RTRIM(@name) <span class="z-keyword z-operator z-math z-sql">+</span><span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span><span class="z-constant z-character z-escape z-sql">\]</span><span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql">EXEC (@SQL)
</span><span class="z-source z-sql">PRINT <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>Dropped Function: <span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> @name
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @name <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> \[name\] <span class="z-keyword z-other z-DML z-sql">FROM</span> sysobjects <span class="z-keyword z-other z-DML z-sql">WHERE</span> \[type\] <span class="z-keyword z-operator z-logical z-sql">IN</span> (N<span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>FN<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>, N<span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>IF<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>, N<span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>TF<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>, N<span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>FS<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>, N<span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>FT<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>) <span class="z-keyword z-operator z-logical z-sql">AND</span> category <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-constant z-numeric z-sql">0</span> <span class="z-keyword z-operator z-logical z-sql">AND</span> \[name\] <span class="z-keyword z-operator z-comparison z-sql">&gt;</span> @name <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> \[name\])
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">END</span>
</span><span class="z-source z-sql">GO
</span><span class="z-source z-sql">
</span><span class="z-source z-sql"><span class="z-comment z-line z-double-dash z-sql"><span class="z-punctuation z-definition z-comment z-sql">--</span> Drop all Foreign Key constraints
</span></span><span class="z-source z-sql">DECLARE @name <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">128</span>)
</span><span class="z-source z-sql">DECLARE @<span class="z-storage z-modifier z-sql">constraint</span> <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">254</span>)
</span><span class="z-source z-sql">DECLARE @SQL <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">254</span>)
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @name <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> TABLE\_NAME <span class="z-keyword z-other z-DML z-sql">FROM</span> INFORMATION\<span class="z-constant z-other z-database-name z-sql">_SCHEMA</span>.<span class="z-constant z-other z-table-name z-sql">TABLE</span>\_CONSTRAINTS <span class="z-keyword z-other z-DML z-sql">WHERE</span> <span class="z-storage z-modifier z-sql">constraint</span>\_catalog<span class="z-keyword z-operator z-comparison z-sql">=</span>DB\_NAME<span class="z-meta z-block z-sql"><span class="z-punctuation z-section z-scope z-begin z-sql">(</span><span class="z-punctuation z-section z-scope z-end z-sql">)</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_TYPE <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>FOREIGN KEY<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> TABLE\_NAME)
</span><span class="z-source z-sql">WHILE @name <span class="z-keyword z-operator z-logical z-sql">is</span> <span class="z-keyword z-operator z-logical z-sql">not</span> <span class="z-constant z-language z-sql">null</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-LUW z-sql">BEGIN</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @<span class="z-storage z-modifier z-sql">constraint</span> <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_NAME <span class="z-keyword z-other z-DML z-sql">FROM</span> INFORMATION\<span class="z-constant z-other z-database-name z-sql">_SCHEMA</span>.<span class="z-constant z-other z-table-name z-sql">TABLE</span>\_CONSTRAINTS <span class="z-keyword z-other z-DML z-sql">WHERE</span> <span class="z-storage z-modifier z-sql">constraint</span>\_catalog<span class="z-keyword z-operator z-comparison z-sql">=</span>DB\_NAME<span class="z-meta z-block z-sql"><span class="z-punctuation z-section z-scope z-begin z-sql">(</span><span class="z-punctuation z-section z-scope z-end z-sql">)</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_TYPE <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>FOREIGN KEY<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> TABLE\_NAME <span class="z-keyword z-operator z-comparison z-sql">=</span> @name <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_NAME)
</span><span class="z-source z-sql">WHILE @<span class="z-storage z-modifier z-sql">constraint</span> <span class="z-keyword z-operator z-logical z-sql">IS</span> <span class="z-keyword z-operator z-logical z-sql">NOT</span> <span class="z-constant z-language z-sql">NULL</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-LUW z-sql">BEGIN</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @SQL <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>ALTER TABLE <span class="z-constant z-character z-escape z-sql">\[</span>dbo<span class="z-constant z-character z-escape z-sql">\]</span>.<span class="z-constant z-character z-escape z-sql">\[</span><span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> RTRIM(@name) <span class="z-keyword z-operator z-math z-sql">+</span><span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span><span class="z-constant z-character z-escape z-sql">\]</span> DROP CONSTRAINT <span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> RTRIM(@<span class="z-storage z-modifier z-sql">constraint</span>)
</span><span class="z-source z-sql">EXEC (@SQL)
</span><span class="z-source z-sql">PRINT <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>Dropped FK Constraint: <span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> @<span class="z-storage z-modifier z-sql">constraint</span> <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> on <span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> @name
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @<span class="z-storage z-modifier z-sql">constraint</span> <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_NAME <span class="z-keyword z-other z-DML z-sql">FROM</span> INFORMATION\<span class="z-constant z-other z-database-name z-sql">_SCHEMA</span>.<span class="z-constant z-other z-table-name z-sql">TABLE</span>\_CONSTRAINTS <span class="z-keyword z-other z-DML z-sql">WHERE</span> <span class="z-storage z-modifier z-sql">constraint</span>\_catalog<span class="z-keyword z-operator z-comparison z-sql">=</span>DB\_NAME<span class="z-meta z-block z-sql"><span class="z-punctuation z-section z-scope z-begin z-sql">(</span><span class="z-punctuation z-section z-scope z-end z-sql">)</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_TYPE <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>FOREIGN KEY<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_NAME <span class="z-keyword z-operator z-comparison z-sql">&lt;&gt;</span> @<span class="z-storage z-modifier z-sql">constraint</span> <span class="z-keyword z-operator z-logical z-sql">AND</span> TABLE\_NAME <span class="z-keyword z-operator z-comparison z-sql">=</span> @name <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_NAME)
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">END</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @name <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> TABLE\_NAME <span class="z-keyword z-other z-DML z-sql">FROM</span> INFORMATION\<span class="z-constant z-other z-database-name z-sql">_SCHEMA</span>.<span class="z-constant z-other z-table-name z-sql">TABLE</span>\_CONSTRAINTS <span class="z-keyword z-other z-DML z-sql">WHERE</span> <span class="z-storage z-modifier z-sql">constraint</span>\_catalog<span class="z-keyword z-operator z-comparison z-sql">=</span>DB\_NAME<span class="z-meta z-block z-sql"><span class="z-punctuation z-section z-scope z-begin z-sql">(</span><span class="z-punctuation z-section z-scope z-end z-sql">)</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_TYPE <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>FOREIGN KEY<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> TABLE\_NAME)
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">END</span>
</span><span class="z-source z-sql">GO
</span><span class="z-source z-sql">
</span><span class="z-source z-sql"><span class="z-comment z-line z-double-dash z-sql"><span class="z-punctuation z-definition z-comment z-sql">--</span> Drop all Primary Key constraints
</span></span><span class="z-source z-sql">DECLARE @name <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">128</span>)
</span><span class="z-source z-sql">DECLARE @<span class="z-storage z-modifier z-sql">constraint</span> <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">254</span>)
</span><span class="z-source z-sql">DECLARE @SQL <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">254</span>)
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @name <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> TABLE\_NAME <span class="z-keyword z-other z-DML z-sql">FROM</span> INFORMATION\<span class="z-constant z-other z-database-name z-sql">_SCHEMA</span>.<span class="z-constant z-other z-table-name z-sql">TABLE</span>\_CONSTRAINTS <span class="z-keyword z-other z-DML z-sql">WHERE</span> <span class="z-storage z-modifier z-sql">constraint</span>\_catalog<span class="z-keyword z-operator z-comparison z-sql">=</span>DB\_NAME<span class="z-meta z-block z-sql"><span class="z-punctuation z-section z-scope z-begin z-sql">(</span><span class="z-punctuation z-section z-scope z-end z-sql">)</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_TYPE <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>PRIMARY KEY<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> TABLE\_NAME)
</span><span class="z-source z-sql">WHILE @name <span class="z-keyword z-operator z-logical z-sql">IS</span> <span class="z-keyword z-operator z-logical z-sql">NOT</span> <span class="z-constant z-language z-sql">NULL</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-LUW z-sql">BEGIN</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @<span class="z-storage z-modifier z-sql">constraint</span> <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_NAME <span class="z-keyword z-other z-DML z-sql">FROM</span> INFORMATION\<span class="z-constant z-other z-database-name z-sql">_SCHEMA</span>.<span class="z-constant z-other z-table-name z-sql">TABLE</span>\_CONSTRAINTS <span class="z-keyword z-other z-DML z-sql">WHERE</span> <span class="z-storage z-modifier z-sql">constraint</span>\_catalog<span class="z-keyword z-operator z-comparison z-sql">=</span>DB\_NAME<span class="z-meta z-block z-sql"><span class="z-punctuation z-section z-scope z-begin z-sql">(</span><span class="z-punctuation z-section z-scope z-end z-sql">)</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_TYPE <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>PRIMARY KEY<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> TABLE\_NAME <span class="z-keyword z-operator z-comparison z-sql">=</span> @name <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_NAME)
</span><span class="z-source z-sql">WHILE @<span class="z-storage z-modifier z-sql">constraint</span> <span class="z-keyword z-operator z-logical z-sql">is</span> <span class="z-keyword z-operator z-logical z-sql">not</span> <span class="z-constant z-language z-sql">null</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-LUW z-sql">BEGIN</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @SQL <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>ALTER TABLE <span class="z-constant z-character z-escape z-sql">\[</span>dbo<span class="z-constant z-character z-escape z-sql">\]</span>.<span class="z-constant z-character z-escape z-sql">\[</span><span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> RTRIM(@name) <span class="z-keyword z-operator z-math z-sql">+</span><span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span><span class="z-constant z-character z-escape z-sql">\]</span> DROP CONSTRAINT <span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> RTRIM(@<span class="z-storage z-modifier z-sql">constraint</span>)
</span><span class="z-source z-sql">EXEC (@SQL)
</span><span class="z-source z-sql">PRINT <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>Dropped PK Constraint: <span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> @<span class="z-storage z-modifier z-sql">constraint</span> <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> on <span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> @name
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @<span class="z-storage z-modifier z-sql">constraint</span> <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_NAME <span class="z-keyword z-other z-DML z-sql">FROM</span> INFORMATION\<span class="z-constant z-other z-database-name z-sql">_SCHEMA</span>.<span class="z-constant z-other z-table-name z-sql">TABLE</span>\_CONSTRAINTS <span class="z-keyword z-other z-DML z-sql">WHERE</span> <span class="z-storage z-modifier z-sql">constraint</span>\_catalog<span class="z-keyword z-operator z-comparison z-sql">=</span>DB\_NAME<span class="z-meta z-block z-sql"><span class="z-punctuation z-section z-scope z-begin z-sql">(</span><span class="z-punctuation z-section z-scope z-end z-sql">)</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_TYPE <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>PRIMARY KEY<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_NAME <span class="z-keyword z-operator z-comparison z-sql">&lt;&gt;</span> @<span class="z-storage z-modifier z-sql">constraint</span> <span class="z-keyword z-operator z-logical z-sql">AND</span> TABLE\_NAME <span class="z-keyword z-operator z-comparison z-sql">=</span> @name <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_NAME)
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">END</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @name <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> TABLE\_NAME <span class="z-keyword z-other z-DML z-sql">FROM</span> INFORMATION\<span class="z-constant z-other z-database-name z-sql">_SCHEMA</span>.<span class="z-constant z-other z-table-name z-sql">TABLE</span>\_CONSTRAINTS <span class="z-keyword z-other z-DML z-sql">WHERE</span> <span class="z-storage z-modifier z-sql">constraint</span>\_catalog<span class="z-keyword z-operator z-comparison z-sql">=</span>DB\_NAME<span class="z-meta z-block z-sql"><span class="z-punctuation z-section z-scope z-begin z-sql">(</span><span class="z-punctuation z-section z-scope z-end z-sql">)</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> <span class="z-storage z-modifier z-sql">CONSTRAINT</span>\_TYPE <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>PRIMARY KEY<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> TABLE\_NAME)
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">END</span>
</span><span class="z-source z-sql">GO
</span><span class="z-source z-sql">
</span><span class="z-source z-sql"><span class="z-comment z-line z-double-dash z-sql"><span class="z-punctuation z-definition z-comment z-sql">--</span> Drop all tables
</span></span><span class="z-source z-sql">DECLARE @name <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">128</span>)
</span><span class="z-source z-sql">DECLARE @SQL <span class="z-storage z-type z-sql">VARCHAR</span>(<span class="z-constant z-numeric z-sql">254</span>)
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @name <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> \[name\] <span class="z-keyword z-other z-DML z-sql">FROM</span> sysobjects <span class="z-keyword z-other z-DML z-sql">WHERE</span> \[type\] <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>U<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> category <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-constant z-numeric z-sql">0</span> <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> \[name\])
</span><span class="z-source z-sql">WHILE @name <span class="z-keyword z-operator z-logical z-sql">IS</span> <span class="z-keyword z-operator z-logical z-sql">NOT</span> <span class="z-constant z-language z-sql">NULL</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-LUW z-sql">BEGIN</span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @SQL <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>DROP TABLE <span class="z-constant z-character z-escape z-sql">\[</span>dbo<span class="z-constant z-character z-escape z-sql">\]</span>.<span class="z-constant z-character z-escape z-sql">\[</span><span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> RTRIM(@name) <span class="z-keyword z-operator z-math z-sql">+</span><span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span><span class="z-constant z-character z-escape z-sql">\]</span><span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql">EXEC (@SQL)
</span><span class="z-source z-sql">PRINT <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>Dropped Table: <span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-math z-sql">+</span> @name
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">SELECT</span> @name <span class="z-keyword z-operator z-comparison z-sql">=</span> (<span class="z-keyword z-other z-DML z-sql">SELECT TOP</span> <span class="z-constant z-numeric z-sql">1</span> \[name\] <span class="z-keyword z-other z-DML z-sql">FROM</span> sysobjects <span class="z-keyword z-other z-DML z-sql">WHERE</span> \[type\] <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>U<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span> <span class="z-keyword z-operator z-logical z-sql">AND</span> category <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-constant z-numeric z-sql">0</span> <span class="z-keyword z-operator z-logical z-sql">AND</span> \[name\] <span class="z-keyword z-operator z-comparison z-sql">&gt;</span> @name <span class="z-keyword z-other z-DML z-sql">ORDER BY</span> \[name\])
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">END</span>
</span><span class="z-source z-sql">GO
</span><span class="z-source z-sql">
</span><span class="z-source z-sql"><span class="z-comment z-line z-double-dash z-sql"><span class="z-punctuation z-definition z-comment z-sql">--</span> Drop all indexes
</span></span><span class="z-source z-sql">declare @RETURN\_VALUE <span class="z-storage z-type z-sql">int</span>
</span><span class="z-source z-sql">declare @command1 <span class="z-storage z-type z-sql">nvarchar</span>(<span class="z-constant z-numeric z-sql">2000</span>)
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>DECLARE @indexName NVARCHAR(128)<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> DECLARE @dropIndexSql NVARCHAR(4000)<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> DECLARE tableIndexes CURSOR FAST<span class="z-constant z-character z-escape z-sql">\_</span>FORWARD FOR<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> SELECT name FROM sys.indexes<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> WHERE object<span class="z-constant z-character z-escape z-sql">\_</span>id = OBJECT<span class="z-constant z-character z-escape z-sql">\_</span>ID(<span class="z-constant z-character z-escape z-sql">&#39;&#39;</span>?<span class="z-constant z-character z-escape z-sql">&#39;&#39;</span>) AND index<span class="z-constant z-character z-escape z-sql">\_</span>id &gt; 0 AND index<span class="z-constant z-character z-escape z-sql">\_</span>id &lt; 255 AND is<span class="z-constant z-character z-escape z-sql">\_</span>primary<span class="z-constant z-character z-escape z-sql">\_</span>key = 0<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> ORDER BY index<span class="z-constant z-character z-escape z-sql">\_</span>id DESC<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> OPEN tableIndexes FETCH NEXT FROM tableIndexes INTO @indexName<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> WHILE @@fetch<span class="z-constant z-character z-escape z-sql">\_</span>status = 0<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> BEGIN<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> SET @dropIndexSql = N<span class="z-constant z-character z-escape z-sql">&#39;&#39;</span>DROP INDEX ?.<span class="z-constant z-character z-escape z-sql">\[</span><span class="z-constant z-character z-escape z-sql">&#39;&#39;</span> + @indexName + <span class="z-constant z-character z-escape z-sql">&#39;&#39;</span><span class="z-constant z-character z-escape z-sql">\]</span><span class="z-constant z-character z-escape z-sql">&#39;&#39;</span><span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> EXEC sp<span class="z-constant z-character z-escape z-sql">\_</span>executesql @dropIndexSql<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> print @dropIndexSql<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> FETCH NEXT FROM tableIndexes INTO @indexName<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> END<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> CLOSE tableIndexes<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">set</span> @command1 <span class="z-keyword z-operator z-comparison z-sql">=</span> @command1 <span class="z-keyword z-operator z-math z-sql">+</span> <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span> DEALLOCATE tableIndexes<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql">Print <span class="z-string z-quoted z-single z-sql"><span class="z-punctuation z-definition z-string z-begin z-sql">&#39;</span>-----------------------------------------<span class="z-punctuation z-definition z-string z-end z-sql">&#39;</span></span>
</span><span class="z-source z-sql">exec @RETURN\_VALUE <span class="z-keyword z-operator z-comparison z-sql">=</span> sp\_MSforeachtable @command1<span class="z-keyword z-operator z-comparison z-sql">=</span>@command1
</span><span class="z-source z-sql">GO
</span></code></pre>
<p>Segue o link para o post, no qual encontrei este script: <a href="http://paigecsharp.blogspot.com/2008/03/drop-all-objects-in-sql-server-database.html">http://paigecsharp.blogspot.com/2008/03/drop-all-objects-in-sql-server-database.html</a></p>

  </div>

  <footer>
    <a class="blog_post__revision" href="https://github.com/maxclaus/maxclaus.xyz/commits/main/content/blog&#x2F;2011-11-17-excluir-todos-os-objetos-no-sql-server.md">revision history</a>
  </footer>
</article>

      </div>
      <footer id="footer">
        <p> Copyright © 2025 Max Claus. All rights reserved. </p>
      </footer>
      <div hidden itemscope itemtype="http://schema.org/Person">
        <span itemprop="gender">Male</span>
        <span itemprop="email">maxclaus@posteo.com</span>
        <span itemprop="givenName">Max</span>
        <span itemprop="familyName">Claus</span>
        <span itemprop="name">Max Claus Nunes</span>
        <span itemprop="birthDate">1989-09-12</span>
        <span itemprop="jobTitle">Software Engineer</span>
        <span itemprop="nationality">BR</span>
        <a href="https://maxclaus.xyz" itemprop="url">Portfolio</a>
        <a href="https://maxclaus.xyz/blog" itemprop="url">Blog</a>
        <a href="https://maxclaus.xyz/resume" itemprop="url">Resume</a>
      </div>
    </div>
  </body>
</html>
